{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from \"vue\";\nimport axios from \"axios\";\nimport router from \"@/router\";\nexport default {\n  __name: 'SignUpView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const name = ref(\"\");\n    const email = ref(\"\");\n    const password = ref(\"\");\n    const errorMessage = ref(\"\");\n    const successMessage = ref(\"\");\n    const handleSubmit = async () => {\n      try {\n        const response = await axios.post(\"http://localhost:8000/api/register\", {\n          name: name.value,\n          email: email.value,\n          password: password.value\n        });\n        if (response.status === 201) {\n          const token = localStorage.getItem('token');\n          if (token) {\n            axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\n          }\n          // Send the verification email after successful registration\n          await sendVerificationEmail();\n          successMessage.value = \"Signed up successfully! Please check your email to verify.\";\n          name.value = \"\";\n          email.value = \"\";\n          password.value = \"\";\n          router.push(\"/signin\");\n        }\n      } catch (error) {\n        if (error.response) {\n          errorMessage.value = error.response.data.message || \"Sign up failed.\";\n        } else {\n          errorMessage.value = \"Server error. Please try again later.\";\n        }\n      }\n    };\n    const sendVerificationEmail = async () => {\n      try {\n        const response = await axios.post(\"http://localhost:8000/api/email/send-verification\");\n        console.log(response.status);\n        if (response.status === 200) {\n          alert(\"Verification email sent. Please check your inbox.\");\n        }\n      } catch (error) {\n        if (error.response && error.response.status === 403) {\n          alert(\"Your email is not verified. Please check your inbox.\");\n        } else {\n          alert(\"Failed to send verification email. Please try again later.\");\n        }\n      }\n    };\n    const __returned__ = {\n      name,\n      email,\n      password,\n      errorMessage,\n      successMessage,\n      handleSubmit,\n      sendVerificationEmail,\n      ref,\n      get axios() {\n        return axios;\n      },\n      get router() {\n        return router;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","axios","router","name","email","password","errorMessage","successMessage","handleSubmit","response","post","value","status","token","localStorage","getItem","defaults","headers","common","sendVerificationEmail","push","error","data","message","console","log","alert"],"sources":["F:/sample/frontend/src/views/SignUpView.vue"],"sourcesContent":["<script setup>\r\nimport { ref } from \"vue\";\r\nimport axios from \"axios\";\r\nimport router from \"@/router\";\r\n\r\nconst name = ref(\"\");\r\nconst email = ref(\"\");\r\nconst password = ref(\"\");\r\nconst errorMessage = ref(\"\");\r\nconst successMessage = ref(\"\");\r\n\r\nconst handleSubmit = async () => {\r\n  try {\r\n    const response = await axios.post(\"http://localhost:8000/api/register\", {\r\n      name: name.value,\r\n      email: email.value,\r\n      password: password.value,\r\n    });\r\n\r\n    if (response.status === 201) {\r\n      const token = localStorage.getItem('token'); \r\nif (token) {\r\n  axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;\r\n}\r\n      // Send the verification email after successful registration\r\n      await sendVerificationEmail();\r\n\r\n      successMessage.value =\r\n        \"Signed up successfully! Please check your email to verify.\";\r\n      name.value = \"\";\r\n      email.value = \"\";\r\n      password.value = \"\";\r\n      router.push(\"/signin\");\r\n    }\r\n  } catch (error) {\r\n    if (error.response) {\r\n      errorMessage.value = error.response.data.message || \"Sign up failed.\";\r\n    } else {\r\n      errorMessage.value = \"Server error. Please try again later.\";\r\n    }\r\n  }\r\n};\r\n\r\nconst sendVerificationEmail = async () => {\r\n  try {\r\n    const response = await axios.post(\r\n      \"http://localhost:8000/api/email/send-verification\"\r\n    );\r\n    console.log(response.status);\r\n    if (response.status === 200) {\r\n      alert(\"Verification email sent. Please check your inbox.\");\r\n    }\r\n  } catch (error) {\r\n    if (error.response && error.response.status === 403) {\r\n      alert(\"Your email is not verified. Please check your inbox.\");\r\n    } else {\r\n      alert(\"Failed to send verification email. Please try again later.\");\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<template>\r\n  <div class=\"flex items-center justify-center min-h-screen bg-gray-100\">\r\n    <div class=\"w-full max-w-md p-8 bg-white rounded-lg shadow-lg\">\r\n      <h2 class=\"text-2xl font-bold text-center text-gray-700\">Sign Up</h2>\r\n      <form @submit.prevent=\"handleSubmit\">\r\n        <div class=\"mt-6\">\r\n          <label for=\"name\" class=\"block mb-2 text-sm font-medium text-gray-600\"\r\n            >Name:</label\r\n          >\r\n          <input\r\n            type=\"text\"\r\n            id=\"name\"\r\n            v-model=\"name\"\r\n            required\r\n            placeholder=\"Enter your name\"\r\n            class=\"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-green-200\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"mt-4\">\r\n          <label\r\n            for=\"email\"\r\n            class=\"block mb-2 text-sm font-medium text-gray-600\"\r\n            >Email:</label\r\n          >\r\n          <input\r\n            type=\"email\"\r\n            id=\"email\"\r\n            v-model=\"email\"\r\n            required\r\n            placeholder=\"Enter your email\"\r\n            class=\"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-green-200\"\r\n          />\r\n        </div>\r\n\r\n        <div class=\"mt-4\">\r\n          <label\r\n            for=\"password\"\r\n            class=\"block mb-2 text-sm font-medium text-gray-600\"\r\n            >Password:</label\r\n          >\r\n          <input\r\n            type=\"password\"\r\n            id=\"password\"\r\n            v-model=\"password\"\r\n            required\r\n            placeholder=\"Enter your password\"\r\n            class=\"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring focus:ring-green-200\"\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          class=\"w-full mt-6 p-2 text-white bg-green-600 rounded-md hover:bg-green-700 focus:outline-none focus:ring focus:ring-green-200\"\r\n        >\r\n          Sign Up\r\n        </button>\r\n      </form>\r\n\r\n      <p v-if=\"errorMessage\" class=\"mt-4 text-red-600 text-sm text-center\">\r\n        {{ errorMessage }}\r\n      </p>\r\n      <p v-if=\"successMessage\" class=\"mt-4 text-green-600 text-sm text-center\">\r\n        {{ successMessage }}\r\n      </p>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style scoped>\r\n</style>\r\n"],"mappings":";AACA,SAASA,GAAG,QAAQ,KAAK;AACzB,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,MAAM,MAAM,UAAU;;;;;;;IAE7B,MAAMC,IAAI,GAAGH,GAAG,CAAC,EAAE,CAAC;IACpB,MAAMI,KAAK,GAAGJ,GAAG,CAAC,EAAE,CAAC;IACrB,MAAMK,QAAQ,GAAGL,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMM,YAAY,GAAGN,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMO,cAAc,GAAGP,GAAG,CAAC,EAAE,CAAC;IAE9B,MAAMQ,YAAY,GAAG,MAAAA,CAAA,KAAY;MAC/B,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMR,KAAK,CAACS,IAAI,CAAC,oCAAoC,EAAE;UACtEP,IAAI,EAAEA,IAAI,CAACQ,KAAK;UAChBP,KAAK,EAAEA,KAAK,CAACO,KAAK;UAClBN,QAAQ,EAAEA,QAAQ,CAACM;QACrB,CAAC,CAAC;QAEF,IAAIF,QAAQ,CAACG,MAAM,KAAK,GAAG,EAAE;UAC3B,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;UACjD,IAAIF,KAAK,EAAE;YACTZ,KAAK,CAACe,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,CAAC,GAAG,UAAUL,KAAK,EAAE;UACpE;UACM;UACA,MAAMM,qBAAqB,CAAC,CAAC;UAE7BZ,cAAc,CAACI,KAAK,GAClB,4DAA4D;UAC9DR,IAAI,CAACQ,KAAK,GAAG,EAAE;UACfP,KAAK,CAACO,KAAK,GAAG,EAAE;UAChBN,QAAQ,CAACM,KAAK,GAAG,EAAE;UACnBT,MAAM,CAACkB,IAAI,CAAC,SAAS,CAAC;QACxB;MACF,CAAC,CAAC,OAAOC,KAAK,EAAE;QACd,IAAIA,KAAK,CAACZ,QAAQ,EAAE;UAClBH,YAAY,CAACK,KAAK,GAAGU,KAAK,CAACZ,QAAQ,CAACa,IAAI,CAACC,OAAO,IAAI,iBAAiB;QACvE,CAAC,MAAM;UACLjB,YAAY,CAACK,KAAK,GAAG,uCAAuC;QAC9D;MACF;IACF,CAAC;IAED,MAAMQ,qBAAqB,GAAG,MAAAA,CAAA,KAAY;MACxC,IAAI;QACF,MAAMV,QAAQ,GAAG,MAAMR,KAAK,CAACS,IAAI,CAC/B,mDACF,CAAC;QACDc,OAAO,CAACC,GAAG,CAAChB,QAAQ,CAACG,MAAM,CAAC;QAC5B,IAAIH,QAAQ,CAACG,MAAM,KAAK,GAAG,EAAE;UAC3Bc,KAAK,CAAC,mDAAmD,CAAC;QAC5D;MACF,CAAC,CAAC,OAAOL,KAAK,EAAE;QACd,IAAIA,KAAK,CAACZ,QAAQ,IAAIY,KAAK,CAACZ,QAAQ,CAACG,MAAM,KAAK,GAAG,EAAE;UACnDc,KAAK,CAAC,sDAAsD,CAAC;QAC/D,CAAC,MAAM;UACLA,KAAK,CAAC,4DAA4D,CAAC;QACrE;MACF;IACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}